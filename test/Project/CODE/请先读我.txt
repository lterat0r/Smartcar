》》》》》》》》》》》》》》》第十六届智能车专科四轮组程序说明《《《《《《《《《《《《《《《《《《《《《《《《

需要注意一下定时器的分配问题哦！！
                                串口1使用定时器1作为波特率发生器，
//								串口2使用定时器2作为波特率发生器，
//								串口3使用定时器3作为波特率发生器，
//								串口4使用定时器4作为波特率发生器，
//                              STC16F仅有定时器0-定时器4，这5个定时器。
//								编码器采集数据也需要定时器作为外部计数。


电感值

直道：1300·1500    350~450
圆环附近：2400~2600   靠近圆环竖电感值 2800  另外竖电感：900
圆环中间：全部2500~2700


程序说明：
硬件说明：
本次程序为专科电磁四轮，使用C车模，相对很好调
程序兼容性完善了，基于逐飞库编写，硬件可以使用逐飞的、龙邱的都可以，都可以用的哦！根据需求到headfile头文件修改对应的硬件引脚宏定义即可！
电机驱动目前有两种，常见的是MOS驱动，驱动一个电机需要两路PWM，论文一种是DRV驱动，只需要一路PWM，另外一个引脚是普通的IO口用来控制PWM方向的，两种驱动程序都有了，修改宏定义即可兼容，默认MOS驱动！
转向循迹使用的是电磁电感转向，程序写了五路电感，但是实际循迹只用了两个电感哦，其他的都只是辅助！同样可以任意修改引脚宏定义的！
车库识别使用的是干簧管（霍尔元器件），在这里说明一下，除非使用摄像头类传感器识别斑马线可以直接控制车模驶入车库，其他干簧管方式都需要倒车操作，因为惯性，识别得过迟了！
其他外设的话简单不作介绍了，OLED屏幕、按键、拨码开关什么的！


程序说明：
程序大部分都有注释了。
程序的话主要看main文件的初始化函数和main函数里面写的东西
其次需要到fuse文件看核心的控制，fuse文件里面的函数是在中断中执行的，中断可以到isr文件中看！
不要问为什么要分开写，车模控制每个环节周期都不一样的，不是说全部放while1里面好，本次写的应该条理比较清晰，大家可以尝试着仿照着写，这个程序框架，我用了三年，传给实验室的学弟们，现在大部分人也在沿袭我的操作！

需要注意定时器分配的问题，这个最开始那里已经标出，不能冲突哦，否则影响使用！

Function文件：
主要是一些算法，写成了函数形式方便调用，当然我把所有需要调节的PID参数都放到了该文件最前面，调参数可以到这个文件里面看
简单说一下，PID参数都是4个元素的数组，分别是：P、I、D、KT（对I的限幅）！！！！
举个例子：Turn_Pid[][4]  = { {1.2,0.2,0,200},    //这个转向的PID中，1.2就是P，0.2就是I，0就是D，200就是对第二项I输出限幅！其他类似！

fuse文件：
中断执行的函数，也是程序核心控制调用，相当于是一个时间周期任务处理，不同时间调用不同控制函数，融合控制车模！

speed文件：
 含编码器相关的、电机相关的所有函数！
 
Direction文件：
里面主要是电磁处理相关的，和舵机初始化转向输出控制函数！

debug文件：
含有调试相关的功能函数，串口上位机发送数据的，按键、拨码开关调参的初始化的，屏幕显示的，舵机、电机、电磁测试函数、蜂鸣器控制

NewOther文件：
内含车库控制的，包括出库入库

程序基本是大部分了，可能还存在细节的问题，欢迎与我交流！

程序因为硬件没有编码器和陀螺仪这些，受限制了，但是程序我保留书写了编码器闭环相关的控制，如果后续有相关硬件，仅需打开注释就可以啦，可能元素需要继续优化完善！

提供点思路，对于元素的话
A、编码器积分是路程，可以大致测量车模运行的距离
B、陀螺仪在过环时横向角速度积分就是角度，360度是一个圆圈！
C、元素可以根据情况使用不同的PID参数
D、坡道只要编码器闭环了，不可能上不去
E、调元素需要一步一步来，每一个标志位一步一步来
我写了下面这个就是我调元素用的，也就是为了验证我们程序是否合理，比如圆环，你写了第一个条件初次判断圆环，我们就可以把下面这段程序加到你写的后面，看看车子跑过来了会不会停下来以监测你条件那些的合理性！
如果不用了，只要在前面加一个斜线注释就可以
/*################调试专用#############################################
		DisableGlobalIRQ();		//关闭总中断
			 while(1)
			 {
				 go_motor(0,0);
				 BUZZ_OFF;
			 }
//################调试专用#############################################*/


//*************谢谢支持，程序仅供参考，根据自己多年经验书写，希望给新手能够有一些引导参照的作用***************************//
//*************做车还是需要自己亲身去慢慢体会，慢慢去解决遇到的BUG，大家都是这种过来的，去经历这个过程吧！***************//
//*************前人的程序多看多思考为什么要那种写什么的，不懂多查多问多思考，你会学到很多东西的*************************//
//*************预祝大家取得好成绩，当然如果真的想学东西，过程也是很重要的，而不是只是一味去追求结果的，奖不奖的就是一张纸而已**//
//*************珍惜大学校园时光吧，珍惜学校这些比赛平台，趁着年轻多学点东西，不要抱怨自己的专业与这些无关，感兴趣了就埋头干*****//
///////////PS：本人专业不是电子类的，是机械类专业，所以加油吧！//////////////////////////////////////////////////////////////////
			   
			   
			  
			  